<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebApp Test</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>TG WebApp API test</h1>
    <pre id="loadResult"></pre>
    <button id="share1">share1</button>
    <a onclick="navigate('/page2')">Navigate</a>
    <p id="content"></p>

    <script src="https://daccess1.github.io/scripts/index.js?v=2"></script>
    <script type="text/javascript">
        let _wa;

        window.addEventListener('load', () => {
            _wa = window.Telegram.WebApp;
            _wa.expand();
            document.getElementById('loadResult').innerHTML = JSON.stringify(getUserData());
        });

        document.getElementById('share1').addEventListener('click', (e) => {
            window.Telegram.WebView.postEvent(
                "web_app_open_tg_link",
                () => {
                    console.log('postEvent callback')
                },
                {
                    path_full: "/share/url?text=Share"
                }
            );
        });

        function getUserData() {
            const decoded = decodeURI(_wa.initData);
            return decoded;
        }

        function navigate(url) {
            window.history.pushState('page2', 'Page 2', url);
            document.getElementById('content').innerHTML = 'page2';
            _wa.BackButton.show();
        }
    </script>
</body>
</html>